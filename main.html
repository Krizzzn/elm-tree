
<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="UTF-8">
        <title>~/main.elm</title>
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css">
        <style type="text/css">@import url(http://fonts.googleapis.com/css?family=Source+Sans+Pro);
            html, head, body {
                margin: 0;
                height: 100%;
            }
        </style>
    </head>
<body>
    <div id="mynetwork" style="width:90%; height: 650px; border: 1px solid black"> </div>
</body>
<script src="/_compile/main.elm" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
<script>

var app;
if (Elm)
  app = Elm.Main.fullscreen();
else
  app = runElmProgram();

app.ports.tree.subscribe(function(tree) {

  var colors = {
    blue: '#0083BF',
    purple: '#7F3F98',
    green: '#00A886',
    pink: '#EE2375',
    orange: '#FAA21B',
    coolgray06: '#ABA7A7',
    coolgray09: '#78777A',
    coolgray11: '#55565A'
  };


  for (var i = tree.nodes.length - 1; i >= 0; i--) {
    var node = tree.nodes[i];
    node.label = node.name;
    node.margin = 5;

    node.fixed = {y: true};

    if (node.id.match(/NC/)){
      node.color = colors.coolgray11;
    }
    if (node.id.match(/CSF/))
      node.color = colors.coolgray09;
    if (node.id.match(/SO/))
      node.color = colors.coolgray06;
    if (node.id.match(/VISION/)){
     node.mass = 100,
     node.color = colors.blue
   }
 }

  // create an array with nodes
  var nodes = new vis.DataSet(tree.nodes);

  // create an array with edges
  var edges = new vis.DataSet(tree.edges);

  // create a network
  var container = document.getElementById('mynetwork');
  var data = {
    nodes: nodes,
    edges: edges
  };

  var shadow = {
    enabled: true,
    size: 7,
    x: 0,
    y: 3
  };

  var zoomable = true;

  var options = {
    interaction: {
      selectable: zoomable,
      dragNodes: false,
      dragView: zoomable,
      zoomView: zoomable
    },
    edges: {
      font: {
        size: 12
      },
      width: 3
    },
    nodes: {
      shape: 'box',
      margin: 5,
      color: '#7BE141',
      borderWidth: 0,
      shadow: shadow,
      widthConstraint: {
        maximum: 200
      }
    },

    physics: {
      enabled: true
      ,     hierarchicalRepulsion: {
        nodeDistance: 220
      }
    },
    layout: {
      hierarchical: {
        enabled: true,
    //nodeSpacing: 600,
    //nodeDistance: 600,
    levelSeparation:150,
    blockShifting: true,
    edgeMinimization: false,
    direction: "DU",
    sortMethod: "directed"
  }
}
};

var network = new vis.Network(container, data, options);

network.on("doubleClick", function(e){
  if (e.nodes.length > 0)
    app.ports.selectNode.send(e.nodes[0]);
  else
    app.ports.selectNode.send("VISION");
});

});
</script>
</html>
